#+TITLE: Linux
#+HTML_LINK_UP: index.html
#+HTML_LINK_HOME: index.html

* ssh自动发送心跳
  #+BEGIN_SRC sh
    # 打开
    sudo vim /etc/ssh/sshd_config
    # 添加
    ClientAliveInterval 30
    ClientAliveCountMax 6
  #+END_SRC

  [[http://roclinux.cn/?p%3D2643][rsync]]

* Patch
  补丁文件里到底存储了哪些信息呢？看看这个例子：

  #+BEGIN_SRC diff
    --- test0       2006-08-18 09:12:01.000000000 +0800
    +++ test1       2006-08-18 09:13:09.000000000 +0800
    @@ -1,3 +1,4 @@
    +222222
     111111
    -111111
    +222222
     111111

  #+END_SRC

** 补丁头
   补丁头是分别由---/+++开头的两行，用来表示要打补丁的文件。---开头表示旧文件，+++开头表示新文件。
   一个补丁文件中的多个补丁
   一个补丁文件中可能包含以---/+++开头的很多节，每一节用来打一个补丁。所以在一个补丁文件中可以包含好多个补丁。

** 块
   块是补丁中要修改的地方。它通常由一部分不用修改的东西开始和结束。他们只是用来表示要修改的位置。他们通常以@@开始，结束于另一个块的开始或者一个新的补丁头。

** 块的缩进
   块会缩进一列，而这一列是用来表示这一行是要增加还是要删除的。

** 块的第一列
   +号表示这一行是要加上的。-号表示这一行是要删除的。没有加号也没有减号表示这里只是引用的而不需要修改。

** 应用

   #+BEGIN_SRC sh
     # 产生补丁
     diff -uN from-file to-file > to-file.patch

     # 打补丁
     patch -p0 < to-file.patch

     # 取消补丁
     patch -RE -p0 < to-file.patch
   #+END_SRC

   使用版本控制工具时，可以直接用svn diff或git diff生成补丁文件。

** 参考
   [[http://linux-wiki.cn/wiki/zh-hans/%25E8%25A1%25A5%25E4%25B8%2581(patch)%25E7%259A%2584%25E5%2588%25B6%25E4%25BD%259C%25E4%25B8%258E%25E5%25BA%2594%25E7%2594%25A8][补丁(patch)的制作与应用]]

* sed
  #+BEGIN_SRC sh
    # 为所有的org文件加上HTML_LINK_UP
    sed -i "s/^\(#+TITLE:\(.*\)\)/\1\n#+HTML_LINK_UP: index.html\n#+HTML_LINK_HOME: index.html/" *.org
    sed -i "s/^-----//" *.org
    sed -i "s/^\(Time-stamp: .*\)//" *.org
  #+END_SRC
